// if the item exists, we're going to replace the slice
// otherwise we will append a new slice

var cart = $('.cart-slice');
var Cart = modulejs.require('cart');
var cart_item = '<%= @cart_item.id %>';
var item_partial = '<%= j render :partial => "cart_item", locals: {cart_item: @cart_item, cart: @cart, item_view: ItemView.new(@cart_item)} %>';
var add_to_cart_partial = "<%= j render :partial => 'add_to_cart', locals: {product: @cart_item.product, cart: @cart} %>";
var quantity_partial = "<%= j render partial: 'display_product_quantity', locals: {product: @product, cart: @cart} %>";
var cart_totals_partial = "<%= j render partial: 'cart_totals', locals: {cart_view: CartView.new(@cart)} %>";
var cart_item_quantity = '<%= @cart_item.quantity %>';

$('.bag-item-count').text("<%= @cart_quantity %>");
Cart.append_item_to_cart(<%= @cart_item.quantity %>, cart_item, item_partial, add_to_cart_partial, quantity_partial, cart_totals_partial);


// add cart mumbojumbo
$('.listing-quantity-container').html("<%= j render partial: 'display_product_quantity', locals: {product: @product, cart: @cart} %>");
$('.add-to-cart-container').html("<%= j render :partial => 'add_to_cart', locals: {product: @cart_item.product, cart: @cart} %>")

if ( Cart.is_closed() ) Cart.open();

// Drop Menu for Product Option

// $('.drop-menu.product-option').each(function () {
//   $('.drop-menu.product-option').removeClass('selected');
//   $menu_items = $(this).find('.drop-menu-item');
//   $first_item = $menu_items.first();
//   $menu_items.removeClass('selected');
//   $first_item.addClass('selected');
//   $(this).find('.drop-menu-heading').text($first_item.data('product-option'));
// })


// coupons
// $('.shop-totals-and-coupons').off().on('click', '.shop-coupon-code-link', function(event) {
//   if ($(this).siblings('.hidden-container').eq(0).hasClass('hidden')){
//     $(this).siblings('.hidden-container').eq(0).removeClass('hidden')
//   }
//   else{
//     $(this).siblings('.hidden-container').eq(0).addClass('hidden')
//   }
//   return false
// });
